\section{Utworzenie bazy danych na platformie SharePoint}
\sectionauthor{R. Wolniak}

Zgodnie z koncepcją, baza danych została utworzona w środowisku SharePoint. Pierwszym krokiem było stworzenie strony dedykowanej temu procesowi. W ekranie startowym programu należy wybrać opcję \emph{Utwórz witrynę}. Po wybraniu typu \emph{Witryna zespołu} oraz odpowiedniego szablonu określającego wygląd ostatnim krokiem jest zdefiniowanie nazwy tworzonej strony.

Kolejnym krokiem jest utworzenie struktury list oraz plików. Na potrzeby procesu utworzono dwa foldery -- \emph{TempFiles} przechowujący arkusze przed zapisaniem ich danych na listach oraz \emph{ArchivedFiles} przechowujący pliki po zakończeniu procesu.
Ponadto utworzono trzy listy:
\begin{itemize}
    \item \emph{Lista\_Uslug},
    \item \emph{Lista\_Kwot},
    \item \emph{Lista\_Indykacji}.
\end{itemize}
\hfill \break
Ich struktura jest taka sama jak opisana w podsekcji \ref{Subsec: StrukturaBazyDanych}.
W celu dodania tych elementów należy:
\begin{itemize}
    \item otworzyć utworzoną witrynę,
    \item wybrać \emph{Zawartość witryny} z bocznego paska nawigacji,
    \item dodać element przy pomocy przycisku \emph{Nowy},
    \item wybrać typ elementu -- \emph{Biblioteka dokumentów} lub \emph{Lista},
    \item podać nazwę oraz opcjonalnie opis elementu.
\end{itemize}

Po wykonaniu tych kroków folder jest gotowy do użycia. W przypadku list wymagane jest dodatkowo zdefiniowanie kolumn. W tym celu należy:
\begin{itemize}
    \item wejść w utworzoną listę,
    \item wybrać przycisk \emph{Dodaj kolumnę} znajdujący się po prawej stronie domyślnie utworzonych kolumn,
    \item w oknie, które się pojawi, wybrać typ kolumny oraz podać jej nazwę,
    \item po zatwierdzeniu podanych opcji, kolumna zostanie dodana do listy.
\end{itemize}

W celu skonfigurowania wybranych kolumn należy przejść do~ustawień strony, następnie do \emph{Ustawień listy} i wybrać nazwę kolumny przeznaczonej do konfiguracji.\\
Tabela \ref{tab:SharepointList} przedstawia konfigurację kolumn listy:
\begin{table}[h]
    \centering
    \caption{Konfiguracja listy na platformie Sharepoint}
    \label{tab:SharepointList}
    \begin{tabular}{|l|l|}
        \hline
        \textbf{Nazwa kolumny}     & \textbf{Typ}             \\ \hline
        Service\_ID                & Liczba                   \\ \hline
        Service\_Name              & Pojedynczy wiersz tekstu \\ \hline
        Service\_Group             & Pojedynczy wiersz tekstu \\ \hline
        Service\_Sub\_Group        & Pojedynczy wiersz tekstu \\ \hline
        Service\_Main\_Group       & Pojedynczy wiersz tekstu \\ \hline
        Instruction\_Link          & Pojedynczy wiersz tekstu \\ \hline
        Unit\_Of\_Measurement      & Pojedynczy wiersz tekstu \\ \hline
        Settlement\_Type           & Pojedynczy wiersz tekstu \\ \hline
        Business\_Service\_Manager & Pojedynczy wiersz tekstu \\ \hline
        Current\_Year\_Plan\_EUR   & Liczba                   \\ \hline
        QTY\_Current\_Year         & Liczba                   \\ \hline
        Next\_Year\_Plan\_EUR      & Liczba                   \\ \hline
        QTY\_Next\_Year            & Liczba                   \\ \hline
        Difference                 & Obliczeniowa             \\ \hline
        MPK                        & Pojedynczy wiersz tekstu \\ \hline
        Year                       & Liczba                   \\ \hline
        IndicationNo               & Liczba                   \\ \hline
        Comment\_Date              & Pojedynczy wiersz tekstu \\ \hline
        Comment\_Author            & Wiele wierszy tekstu     \\ \hline
        Comment\_PZ\_to\_WOB       & Wiele wierszy tekstu     \\ \hline
        Comment\_BSM               & Wiele wierszy tekstu     \\ \hline
        Comment\_K-DES             & Wiele wierszy tekstu     \\ \hline
        Comment\_Intern            & Wiele wierszy tekstu     \\ \hline
        Decision                   & Liczba                   \\ \hline
        Final\_comment             & Wiele wierszy tekstu     \\ \hline
    \end{tabular}
\end{table}

\noindent Kolumna \emph{Difference} jest kolumną obliczeniową, co oznacza, że jej wartość jest obliczana względem podanej formuły. W tym przypadku oblicza ona różnicę cen między rokiem następnym a bieżącym. \\
Kolumna \emph{MPK}, pomimo wartości liczbowych, jest typu tekstowego, gdyż znacznie upraszcza to filtrowanie oraz przepisywanie istniejących numerów do nowych danych. \\
Kolumna \emph{Decision} jest kolumną liczbową, ponieważ status decyzji konwertowany jest na kod liczbowy, aby przyspieszyć proces filtrowania:
\begin{itemize}
    \item \emph{Accepted} $\rightarrow$ 1,
    \item \emph{Not Accepted} $\rightarrow$ -1,
    \item \emph{No Status} $\rightarrow$ 0.
\end{itemize}



